<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="My name is Lucas Marcelli. I like coding, cats and space. This is my website.">

    <title>Thesis! Ahh! - Lucas' Blog and Website</title>

    <link rel="canonical" href="http://marcelli.ca/2015/09/03/thesis/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">
    <link rel="stylesheet" href="/css/style.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>


<body>
	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-57209117-1', 'auto');
	  ga('send', 'pageview');

	</script>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Lucas' Blog and Website</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                
                    <li>
                        
                    </li>      
                
                    <li>
                        
                            <a href="/about/">About</a>
                        
                    </li>      
                
                    <li>
                        
                    </li>      
                
                    <li>
                        
                            <a href="/collections/">Collections</a>
                        
                    </li>      
                
                    <li>
                        
                            <a href="/dog/">Kobe the Dog</a>
                        
                    </li>      
                
                    <li>
                        
                            
                        
                    </li>      
                
                    <li>
                        
                    </li>      
                
                    <li>
                        
                            <a href="/kitty/">Bitty the Kitty</a>
                        
                    </li>      
                
                    <li>
                        
                    </li>      
                
                    <li>
                        
                    </li>      
                
                    <li>
                        
                            <a href="/otherkitty/">Zuko the Kitty</a>
                        
                    </li>      
                
                    <li>
                        
                            <a href="/projects/">Projects</a>
                        
                    </li>      
                
                    <li>
                        
                    </li>      
                
                    <li>
                        
                    </li>      
                
                    <li>
                        
                    </li>      
                
                    <li>
                        
                    </li>      
                
                    <li>
                        
                    </li>      
                
                    <li>
                        
                    </li>      
                
                    <li>
                        
                    </li>      
                
                    <li>
                        
                            
                        
                    </li>      
                
                    <li>
                        
                            
                        
                    </li>      
                
                    <li>
                        
                            
                        
                    </li>      
                
                    <li>
                        
                            
                        
                    </li>      
                
                    <li>
                        
                            
                        
                    </li>      
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/headers/thesis.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Thesis! Ahh!</h1>
                    
                    <h2 class="subheading-post">Let's get started.</h2>
                    
                    <span class="meta"></span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container" id="justify-it">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<p>I started my Graduate Thesis!</p>

<p>It’s pretty neat, and I feel like documenting it so here it goes.</p>

<p>My thesis is a mix of Compsci and Medicine. I never took any biology, but thats what happens when your supervisor is a biomedical researcher I guess.</p>

<p>Ever noticed someone with bulging eyes? Thats usually caused by <a href="https://en.wikipedia.org/wiki/Hyperthyroidism">Hyperthyroidism</a> of some form. In order to treat the underlying cause, it’s neccesary to see how far out the eyes bulge over time. Currently the way to do this is with this:</p>

<p><br /></p>

<div class="img-center">
	<img src="/img/2015Sept/exo.gif" title="Say it 5 times fast" />
	<p> Exophthalmometer </p>
</div>

<p>The doctor places that on your eyes, under the skin on the edges and uses the mirrors to estimate how high your eye is from the fixed base of your skull bone. They do measurements over several weeks to see how quickly the eyes are bulging out. </p>

<p>This is not a comfortable procedure or an accurate one. There has to be a better way!</p>

<div class="img-center">
	<img src="/img/2015Sept/1.png" title="Takes about 10 seconds to scan." />
	<p> Gasp! A better way! </p>
</div>

<p>That is a 3d scan of a patients face. His eyes and skull are right there on that mesh. Why dont we start by marking the fixed points?</p>

<div class="img-center">
	<img src="/img/2015Sept/2.png" title="This was actually hard to implement. I swear." />
	<p> Neat </p>
</div>

<p>I’ve already replicated one part of the procedure. Those points will not move as the eyes do because if they do, the patient likely has injuries not compatible with life. </p>

<p>Now, how did I get those points there? </p>

<p>See, OpenGL gives you an (X,Y) coordinate on the screen for your mouse pointer, but the point needs to be placed at a depth of some Z. Remember Math 111? How you can project from a point to a plane? Turns out you can do the same in reverse. </p>

<p>Ugh, implementing that is gonna be so ha-</p>

<div class="highlight"><pre><code class="language-c--" data-lang="c++"><span class="n">gluUnProject</span><span class="p">(</span> <span class="n">winX</span><span class="p">,</span> <span class="n">winY</span><span class="p">,</span> <span class="n">winZ</span><span class="p">,</span> <span class="n">modelview</span><span class="p">,</span> <span class="n">projection</span><span class="p">,</span> <span class="n">viewport</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">posX</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">posY</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">posZ</span><span class="p">);</span></code></pre></div>

<p>Oh.</p>

<p>Turns out people need to do this pretty often, so it’s included in <a href="https://en.wikipedia.org/wiki/OpenGL_Utility_Toolkit">GLUT</a>. </p>

<p>Once I have the position from that, it’s a simple matter of drawing the sphere at (X,Y,Z).</p>

<p>Now what? I can easily get the distance between the two points by taking the magnitude of one minus the other. I somehow need to get the centre and radius of the eye just from the surface. </p>

<p>Lot’s of people will remember from highschool that you <a href="https://www.khanacademy.org/math/geometry/triangle-properties/perpendicular_bisectors/v/three-points-defining-a-circle">need 3 points to define a circle</a>, but many don’t know that you can extend this into arbitrary dimensions. With 4 points, you can define a <em>unqiue</em> sphere. </p>

<div class="img-center">
	<img src="/img/2015Sept/3.png" title="This was actually hard to implement. I swear." />
	<p> Hey look! 4 points on each eye! </p>
</div>

<p>Now, eyes are roughly the same size across the <em>entire</em> human population. 12 mm radius average with a varaince of only 1mm. This means we can throw out most spheres outright if they are too large or too small to be reasonable!</p>

<p>How do we get the sphere from those 4 points though?</p>

<p>It’s a bit of a mission.</p>

<p>Analytically, it’s incredibly easy. You can solve the problem with basic algebra knowledge in about 5 minutes with any 4 points. Computationally, it’s also easy for the computer to solve, but implementing it requires some thinking.</p>

<p>I took the equations that resulted from solving it analytically and realized that the computer simply had to solve a determinant. After searching the web I stumbled across this:</p>

<div class="img-center">
	<img src="/img/2015Sept/det.png" title="This was actually hard to implement. I swear." />
</div>

<p>Which looked just like the one I had on paper, but it simplified it by splitting it into cofactors.</p>

<div class="img-center">
	<img src="/img/2015Sept/simple.png" title="This was actually hard to implement. I swear." />
</div>

<p>All it took from there was implementing a recursive determininant solver, which has been done a million times before. I ended up implementing my own for performance issues though.</p>

<p>And, voilia!</p>

<div class="img-center">
	<img src="/img/2015Sept/4.png" title="This was actually hard to implement. I swear." />
</div>
<div class="img-center">
	<img src="/img/2015Sept/5.png" title="This was actually hard to implement. I swear." />
</div>

<p>The centre of those spheres is the rough centre of the eyes. Since eyes aren’t truly spherical anyways, the error should be within margin, but I will be improving the position of the sphere later.</p>

<p>The next step is a throwback to Math 111. Those two fixed points have a line between them. To find the distance between the xz plane defined by that line and the centre of each eye, is to find how far the eye is bulging! All I have to do is project the centre point of the spheres onto the plane and the result is the vector between them.</p>

<p>Next time: improvements on the sphere finding algorithim.</p>


                <hr>

                <ul class="pager">
                    
                        <li class="previous">
                            <a href="/2015/08/24/late/" data-toggle="tooltip" data-placement="top" title="I'm Back">&larr; Previous Post</a> 
                        </li>
                     
                    
                        <li class="back">
                            <a href="/thesis" data-toggle="tooltip" data-placement="top" title="Take me back!">Thesis Page</a> 
                        </li>
                        <li class="next">
                            <a href="/2015/10/01/politics/" data-toggle="tooltip" data-placement="top" title="Politics">Next Post &rarr;</a>
                        </li>
                     
                </ul>
                <div class="post-end">
                    <p> Posted by Lucas on September 3, 2015 <br>
                     Lucas is a 1st year Graduate Student at Queen's University studying Computing.</p>
                </div>
                
            </div>
        </div>
    </div>
</article>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/rss.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li> 
                    
                    <li>
                        <a href="https://twitter.com/lucasmarcelli">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://www.facebook.com/lmarcelli">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://github.com/lucasmarcelli">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy; Lucas Marcelli 2015
                    <br>
                    
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


</body>

</html>
